[{"name":"Auto run preview","code":"<script>\n  document.addEventListener(\"simply-data-changed\", function(event) {\n    if (\n      (event.data.dataBinding.parentKey == \"/component/parts/\") ||\n      (event.data.dataBinding.parentKey.indexOf(\"/component/parts/\") == 0)\n    ) {\n      // Handle changes of the part name\n      if (event.data.arguments[0] == \"name\") {\n        var newname = event.data.arguments[1];\n        var oldname = event.data.arguments[2];\n        var component = event.data.dataBinding.parentKey.split(\"/\")[3];\n\n        editor.pageData.app[component].forEach(function(appPart) {\n          if (appPart.name == oldname) {\n            appPart.name = newname;\n          }\n        });\n      }\n      \n      if (typeof autoRunPreviewTimeout !== \"undefined\") {\n        window.clearTimeout(autoRunPreviewTimeout);\n      }\n      autoRunPreviewTimeout = window.setTimeout(function() {\n        // Update the app data for the preview\n        for (component in editor.pageData.component.parts) {\n          editor.pageData.component.parts[component].forEach(function(part) {\n            var found = false;\n            editor.pageData.app[component].forEach(function(appPart) {\n              if (appPart.name == part.name) {\n                appPart.code = JSON.parse(JSON.stringify(part.code));\n                found = true;\n              }\n            });\n            if (!found) {\n              editor.pageData.app[component].push(JSON.parse(JSON.stringify(part)));\n            }\n          });\n        }\n\n        simplyApp.commands.autoRunPreviews()\n      }, 500);\n    }\n  });\n</script>","validateResult":{"messages":[]}}]